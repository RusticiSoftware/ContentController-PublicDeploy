description "Content Controller Server"

  start on runlevel [2345]
  stop on runlevel [!2345]
  respawn
  respawn limit 10 5

  # run as non privileged user
  # add user with this command:
  ## adduser --system --ingroup www-data --home /opt/apache-tomcat apache-tomcat
  # Ubuntu 12.04: (use 'exec sudo -u apache-tomcat' when using 10.04)
  setuid tomcat
  setgid tomcat

  # adapt paths - Replace with your Paths:
  env JAVA_HOME=/usr/lib/jvm/java-8-oracle
  env BINDIR={{ cc_deploy_path }}/bin

  # adapt java options to suit your needs:
  env JAVA_OPTS="-Djava.awt.headless=true -Xmx{{ cc_heap_size }} -XX:+UseConcMarkSweepGC"
  {% if remote_debugging %}
  env CONTENTCONTROLLER_SERVICE_OPTS="-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000"
  {% endif %}

  {% if ClientName is defined %}
  env NEW_RELIC_APP_NAME="{{ ClientName }}-{{ env }}-ContentController"
  {% else %}
  env NEW_RELIC_APP_NAME="{{ env }}"
  {% endif %}

  exec $BINDIR/./contentcontroller-service server $BINDIR/./contentcontroller.yaml

  # cleanup temp directory after stop
  post-stop script
    # This is here as a placeholder
  end script
